<!DOCTYPE html>

<html>

    <head>
        <title>Game</title>
    </head>

    <style>
        #canvas
        {
            margin-left: 7cm;
            margin-top: 2cm;
        }
    </style>

    <body>
        <canvas id="canvas">
            Your browser does not support canvas tag.
        </canvas>

        <script>
            var canvas = document.getElementById('canvas');
            var ctx = canvas.getContext('2d');

            canvas.width = 700;
            canvas.height = 500;


            var mySprite = {
                x: 250,
                y: 470,
                width: 10,
                height: 10,
                speed: 100,
                color: "blue"
            };

            var tool = {
                width: 5,
                height: 5,
                speed: 1000,
                color: "blue",
                active: true
            };

            var keysDown = {};

            window.addEventListener('keydown', function (e) {
                keysDown[e.keyCode] = true;
            });

            window.addEventListener('keyup', function (e) {
                delete keysDown[e.keyCode];
            });

            var mob;

            var mobs = new Array();

            for (i = 0; i < 5; i++) {
                mob = {
                    x: Math.floor(Math.random() * 500),
                    y: 150,
                    width: 10,
                    height: 10,
                    speed: 10,
                    color: "pink"
                };

                mobs.push(mob);
            }

            function update(mod) {
                for (i = 0; i < 5; i++) {
                    mobs[i].y += mob.speed * mod;
                }

                if (37 in keysDown) {
                    mySprite.x = mySprite.x - mySprite.speed * mod;
                }
                if (38 in keysDown) {
                    mySprite.y = mySprite.y - mySprite.speed * mod;
                }
                if (39 in keysDown) {
                    mySprite.x = mySprite.x + mySprite.speed * mod;
                }
                if (40 in keysDown) {
                    mySprite.y = mySprite.y + mySprite.speed * mod;
                }
                if (32 in keysDown) {
                    tool.y = tool.y - tool.speed * mod;
                    if (tool.y <= mySprite.y - 170) {
                        tool.y = mySprite.y;
                        tool.x = mySprite.x;
                    }
                    tool.active = true;
                } else {
                    tool.y = mySprite.y;
                    tool.x = mySprite.x;
                    tool.active = false;
                }

                for (i = 0; i < mobs.length; i++) {
                    if (tool.x < mobs[i].x + mobs[i].width &&
                            tool.y < mobs[i].y + mobs[i].height &&
                            tool.x > mobs[i].x - mobs[i].width &&
                            tool.y > mobs[i].y - mobs[i].height) {
                        mobs[i].height = 0;
                        mobs[i].width = 0;
                    }
                }
            }
            function render() {
                ctx.fillStyle = "orange";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = mySprite.color;
                ctx.fillRect(mySprite.x, mySprite.y, mySprite.width,
                        mySprite.height);
                if (tool.active) {
                    ctx.fillRect(tool.x, tool.y, tool.width, tool.height);
                }

                for (i = 0; i < 5; i++) {
                    ctx.fillStyle = mob.color;
                    ctx.fillRect(mobs[i].x, mobs[i].y, mobs[i].height,
                            mobs[i].width);
                }


            }

            var time = Date.now();

            function run() {
                update((Date.now() - time) / 1000);
                time = Date.now();
                render();
            }

            setInterval(run, 10);

            function restart() {
                alert("Sorry!");
                location.reload(true);
            }
        </script>
    </body>

</html>
